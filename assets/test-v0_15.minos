sintaxis=0.15;

/* Ejemplo de comentario.*/
env ProductUseCases {
    resource Product {
        policy {
            allow = ["crear", "eliminar"];

            rule {
                actor.type = RootUser; /*Comentario2*/
            }

            rule {
                actor.groups *= ["ventas"];
                actor.roles = ["admin"];
            }

            rule {
                actor.groups *= ["ventas"];
                actor.roles = ["admin"];
            }
        }

        policy {
            allow = ["get inner"];

            rule {
                actor.type = CostumerUser;
            }

        }
    }

    resource User {
        policy {
            allow = ["create", "delete", "update", "read"];

            /* The actor and the resource are the same instance */
            rule {
                actor.type = resource.type;
                actor.id = resource.id;
            }
        }

    }
}

env ProductUseCases/tests {

    resource example {
        id = "id.example.a158$";

        policy {
            allow = ["crear", "obtener", "modificar", "eliminar"];

            rule {
                actor.type = RootUser;
            }
            rule {
                actor.type = RootUser;
            }
        }
    }

    resource EXAMPLE {
        id = "i0000";

        policy {
            allow = ["crear", "obtener", "modificar"];

            rule {
                actor.type = RootUser;
            }
            rule {
                actor.type != GuestUser;
            }
        }
    }
}

env ProductUseCases--tests {
    resource example {
        id = "id.example.a158$";

        policy {
            allow = ["crear", "obtener", "modificar", "eliminar"];

            rule {
                actor.type != RootUser;
            }
        }
    }
}


